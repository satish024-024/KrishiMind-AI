<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agri Advisor â€” Smart Agriculture Assistant</title>
    <meta name="description" content="AI-powered agricultural advisor for Indian farmers">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="/dashboard/styles.css">
</head>

<body>
    <!-- SIDEBAR OVERLAY (mobile backdrop) -->
    <div id="sidebarOverlay" class="sidebar-overlay" onclick="toggleSidebar()"></div>
    <!-- SIDEBAR -->
    <aside id="sidebar" class="sidebar">
        <div class="sidebar-logo">
            <div class="logo-icon">ğŸŒ¾</div>
            <div>
                <h1 class="logo-text">Agri Advisor</h1>
                <p class="logo-sub">Powered by AI</p>
            </div>
        </div>
        <nav class="nav">
            <a href="#" class="nav-item active" data-page="dashboard" onclick="navigate('dashboard',this)">
                <span>ğŸ“Š</span> <span data-i18n="nav_dashboard">Dashboard</span></a>
            <a href="#" class="nav-item" data-page="chat" onclick="navigate('chat',this)">
                <span>ğŸ¤–</span> <span data-i18n="nav_ask_ai">Ask AI</span>
                <span class="nav-badge"><span class="pulse-dot"></span> <span
                        data-i18n="nav_online">Online</span></span></a>
            <a href="#" class="nav-item" data-page="weather" onclick="navigate('weather',this)">
                <span>ğŸŒ¤ï¸</span> <span data-i18n="nav_weather">Weather</span></a>
            <a href="#" class="nav-item" data-page="market" onclick="navigate('market',this)">
                <span>ğŸ’°</span> <span data-i18n="nav_market">Market Prices</span></a>
            <a href="#" class="nav-item" data-page="crops" onclick="navigate('crops',this)">
                <span>ğŸŒ±</span> <span data-i18n="nav_crops">Crop Guide</span></a>
            <a href="#" class="nav-item" data-page="pests" onclick="navigate('pests',this)">
                <span>ğŸ›</span> <span data-i18n="nav_pests">Pest Solutions</span></a>
            <a href="#" class="nav-item" data-page="prediction" onclick="navigate('prediction',this)">
                <span>ğŸ“ˆ</span> <span data-i18n="nav_prediction">Price Prediction</span>
                <span class="nav-badge"
                    style="background:linear-gradient(135deg,#f59e0b,#ef4444);color:#fff;font-size:0.55rem;padding:1px 6px">NEW</span></a>
        </nav>
        <div class="sidebar-bottom">
            <div class="lang-select">
                <span>ğŸŒ</span>
                <select id="langSelect">
                    <option value="en">English</option>
                    <option value="hi">à¤¹à¤¿à¤¨à¥à¤¦à¥€</option>
                    <option value="te">à°¤à±†à°²à±à°—à±</option>
                </select>
            </div>
            <div class="user-info">
                <div class="user-avatar">ğŸ‘¤</div>
                <div style="flex:1">
                    <p class="user-name">User</p>
                    <p class="user-role" style="font-size:0.7rem;color:#059669">â— Online</p>
                </div>
                <button onclick="logout()"
                    style="background:none;border:none;cursor:pointer;font-size:1.2rem;opacity:0.7"
                    title="Logout">ğŸšª</button>
            </div>
        </div>
    </aside>

    <!-- MAIN -->
    <main class="main">
        <!-- Header -->
        <header class="header">
            <button class="menu-btn" onclick="toggleSidebar()">â˜°</button>
            <div class="search-wrap">
                <span class="search-icon">ğŸ”</span>
                <input id="globalSearch" type="text" data-i18n-ph="search_placeholder"
                    placeholder="Ask anything about farming..."
                    onkeydown="if(event.key==='Enter'){navigate('chat');askFromGlobal(this.value);this.value=''}">
            </div>
            <button onclick="showLocationPicker()" id="locationBadge" class="location-badge" title="Change location">
                ğŸ“ <span id="locationBadgeText" data-i18n="select_location">Select Location</span>
            </button>
            <button onclick="askFromGlobal(document.getElementById('globalSearch').value)" class="ask-btn">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" />
                </svg> <span data-i18n="btn_ask">Ask</span>
            </button>
            <button onclick="toggleOnline()" id="modeBtn" class="mode-btn online">
                <span id="modeDot" class="mode-dot"></span>
                <span id="modeText">Online</span>
            </button>
        </header>

        <!-- Pages Container -->
        <div class="pages">
            <!-- PAGE: Dashboard (Bento Grid) -->
            <section id="page-dashboard" class="page active">
                <div class="page-pad">
                    <!-- ROW 1: Hero Banner -->
                    <div class="hero-banner" id="heroBanner">
                        <div class="hero-content">
                            <p class="hero-greeting" id="heroGreeting" data-i18n="hero_greeting">Good Evening</p>
                            <h2 class="hero-title" data-i18n="hero_welcome">Welcome back, Farmer! ğŸ‘‹</h2>
                            <p class="hero-sub" id="heroSub" data-i18n="hero_sub">Loading farm overview...</p>
                        </div>
                        <div class="hero-right">
                            <div class="hero-date" id="heroDate"></div>
                            <div class="hero-weather-mini" id="heroWeatherMini">
                                <span class="hero-temp" id="heroTemp">--Â°</span>
                                <span class="hero-wicon" id="heroWicon">ğŸŒ¤ï¸</span>
                            </div>
                        </div>
                        <div class="hero-pattern"></div>
                    </div>

                    <!-- ROW 2: Bento Grid -->
                    <div class="bento-grid">
                        <!-- Wheat Price (with sparkline) -->
                        <div class="bento-card bento-wheat" onclick="navigate('market')" style="--delay:0">
                            <div class="stat-top"><span class="stat-label" data-i18n="wheat_price">Wheat
                                    Price</span><span class="stat-icon bg-amber">ğŸŒ¾</span></div>
                            <p class="stat-val" id="dashWheatPrice">--<span class="stat-unit">/qt</span></p>
                            <p class="stat-delta" id="dashWheatDelta">Loading...</p>
                            <canvas id="wheatSparkline" class="sparkline-canvas" width="160" height="36"></canvas>
                        </div>

                        <!-- Weather (with mini forecast) -->
                        <div class="bento-card bento-weather" onclick="navigate('weather')" style="--delay:1">
                            <div class="stat-top"><span class="stat-label" data-i18n="weather">Weather</span><span
                                    class="stat-icon bg-blue">ğŸŒ¤ï¸</span></div>
                            <p class="stat-val" id="dashTemp">--Â°C</p>
                            <p class="stat-delta" id="dashWeatherDesc">Loading...</p>
                            <div class="mini-forecast" id="miniForecast"></div>
                        </div>

                        <!-- Soil Health (merged gauge) -->
                        <div class="bento-card bento-soil" style="--delay:2">
                            <div class="stat-top"><span class="stat-label" data-i18n="soil_health">Soil
                                    Health</span><span class="stat-icon bg-green">ğŸ§ª</span></div>
                            <div class="gauge-wrap">
                                <svg class="gauge-ring" viewBox="0 0 80 80">
                                    <circle cx="40" cy="40" r="34" fill="none" stroke="#e5e7eb" stroke-width="6" />
                                    <circle id="soilGaugeCircle" cx="40" cy="40" r="34" fill="none" stroke="#22c55e"
                                        stroke-width="6" stroke-linecap="round" stroke-dasharray="213.6"
                                        stroke-dashoffset="213.6" transform="rotate(-90 40 40)"
                                        style="transition:stroke-dashoffset 1.5s ease" />
                                </svg>
                                <div class="gauge-center">
                                    <span class="gauge-val" id="dashSoilVal">--</span>
                                    <span class="gauge-label" data-i18n="moisture">Moisture</span>
                                </div>
                            </div>
                            <p class="stat-delta" id="dashSoilStatus">Loading...</p>
                        </div>

                        <!-- AI Daily Tip (tall anchor card) -->
                        <div class="bento-card bento-aitip" style="--delay:3" id="aiTipCard">
                            <div class="aitip-glow"></div>
                            <div class="aitip-header">
                                <span class="aitip-icon">ğŸ¤–</span>
                                <div>
                                    <p class="aitip-title" data-i18n="ai_daily_tip">AI Daily Tip</p>
                                    <p class="aitip-sub" data-i18n="powered_by">Powered by AI</p>
                                </div>
                            </div>
                            <div class="aitip-body" id="aiTipBody">
                                <div class="skeleton" style="height:14px;width:90%;border-radius:6px;margin-bottom:8px">
                                </div>
                                <div class="skeleton" style="height:14px;width:75%;border-radius:6px;margin-bottom:8px">
                                </div>
                                <div class="skeleton" style="height:14px;width:60%;border-radius:6px"></div>
                            </div>
                            <button class="aitip-ask"
                                onclick="navigate('chat');setTimeout(()=>askQuestion('Give me a farming tip for today based on current weather and season'),300)">
                                <span data-i18n="ask_more">Ask more â†’</span>
                            </button>
                        </div>

                        <!-- 7-Day Temperature Chart -->
                        <div class="bento-card bento-chart" style="--delay:4">
                            <div class="stat-top"><span class="stat-label" data-i18n="seven_day_temp">ğŸ“ˆ 7-Day
                                    Temperature</span></div>
                            <canvas id="tempChart" class="temp-chart-canvas"></canvas>
                        </div>

                        <!-- Market Ticker -->
                        <div class="bento-card bento-ticker" style="--delay:5">
                            <div class="stat-top"><span class="stat-label" data-i18n="market_prices_top">ğŸ’° Market
                                    Prices â€” Top Crops</span>
                                <a href="#" onclick="event.preventDefault();navigate('market')" class="ticker-link"
                                    data-i18n="view_all">View
                                    all â†’</a>
                            </div>
                            <div class="ticker-scroll" id="tickerScroll">
                                <div class="skeleton" style="height:56px;width:140px;border-radius:12px;flex-shrink:0">
                                </div>
                                <div class="skeleton" style="height:56px;width:140px;border-radius:12px;flex-shrink:0">
                                </div>
                                <div class="skeleton" style="height:56px;width:140px;border-radius:12px;flex-shrink:0">
                                </div>
                            </div>
                        </div>

                        <!-- Quick Actions -->
                        <div class="bento-card bento-actions" style="--delay:6">
                            <p class="bento-section-head" data-i18n="quick_actions">âš¡ Quick Actions</p>
                            <div class="quick-grid">
                                <button class="quick-card"
                                    onclick="navigate('chat');setTimeout(()=>askQuestion('What crops should I plant this season?'),300)">
                                    <span class="quick-icon">ğŸŒ±</span>
                                    <div><strong data-i18n="qa_crop">Crop Advice</strong><small
                                            data-i18n="qa_crop_sub">AI recommendation</small></div>
                                </button>
                                <button class="quick-card"
                                    onclick="navigate('chat');setTimeout(()=>askQuestion('How to control pests in my farm?'),300)">
                                    <span class="quick-icon">ğŸ›</span>
                                    <div><strong data-i18n="qa_pest">Pest Check</strong><small
                                            data-i18n="qa_pest_sub">Identify & treat</small></div>
                                </button>
                                <button class="quick-card" onclick="navigate('weather')">
                                    <span class="quick-icon">ğŸŒ§ï¸</span>
                                    <div><strong data-i18n="qa_weather">Weather</strong><small
                                            data-i18n="qa_weather_sub">7-day forecast</small></div>
                                </button>
                                <button class="quick-card" onclick="navigate('market')">
                                    <span class="quick-icon">ğŸ“ˆ</span>
                                    <div><strong data-i18n="qa_market">Market</strong><small
                                            data-i18n="qa_market_sub">Live mandi rates</small></div>
                                </button>
                            </div>
                        </div>

                        <!-- Crop Calendar -->
                        <div class="bento-card bento-calendar" style="--delay:7">
                            <p class="bento-section-head">ğŸ—“ï¸ Crop Calendar â€” <span id="calSeasonName">Rabi
                                    Season</span></p>
                            <div class="calendar-timeline" id="cropCalendar"></div>
                        </div>

                        <!-- Popular Questions -->
                        <div class="bento-card bento-popular" style="--delay:8">
                            <p class="bento-section-head" data-i18n="popular_questions">ğŸ”¥ Popular Questions</p>
                            <div id="dashPopular" class="popular-grid"></div>
                        </div>

                        <!-- Price Prediction Mini Widget -->
                        <div class="bento-card bento-prediction-mini" onclick="navigate('prediction')"
                            style="--delay:9;cursor:pointer;padding-bottom:12px">
                            <div class="stat-top"><span class="stat-label">ğŸ“ˆ Price Forecasts</span><span
                                    class="stat-icon bg-orange">ğŸ”®</span></div>
                            <div id="predictionMiniContent"
                                style="display: flex; gap: 10px; overflow-x: auto; padding-bottom: 4px; scrollbar-width: none;">
                                <!-- Dynamically populated by app.js -->
                                <p class="stat-delta">Loading forecasts...</p>
                            </div>
                        </div>

                        <!-- Activity Feed -->
                        <div class="bento-card bento-feed" style="--delay:10">
                            <p class="bento-section-head" data-i18n="activity_feed">ğŸ“ Activity Feed</p>
                            <div id="activityFeed" class="activity-feed">
                                <div class="feed-item feed-system"><span class="feed-dot dot-green"></span>
                                    <div>
                                        <p>System online â€” FAISS index loaded</p><small>Just now</small>
                                    </div>
                                </div>
                                <div class="feed-item feed-system"><span class="feed-dot dot-blue"></span>
                                    <div>
                                        <p>AI service connected (Gemini)</p><small>Just now</small>
                                    </div>
                                </div>
                                <div class="feed-item feed-system"><span class="feed-dot dot-amber"></span>
                                    <div>
                                        <p>Weather data synced</p><small>Just now</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- PAGE: Chat -->
            <section id="page-chat" class="page">
                <div class="chat-container">
                    <div id="chatArea" class="chat-area">
                        <div class="chat-welcome">
                            <div class="cw-icon">ğŸŒ¾</div>
                            <h2 data-i18n="chat_welcome">Welcome to Agri Advisor</h2>
                            <p data-i18n="chat_welcome_sub">Ask any farming question â€” crop advice, pest control,
                                weather, market prices</p>
                        </div>
                    </div>
                    <div class="chat-input-bar">
                        <input id="chatInput" type="text" data-i18n-ph="chat_placeholder"
                            placeholder="Type your farming question..." onkeydown="if(event.key==='Enter')sendChat()">
                        <button onclick="sendChat()" class="chat-send">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" />
                            </svg>
                        </button>
                    </div>
                </div>
                <!-- Right Panel -->
                <aside class="right-panel">
                    <h3 class="rp-title" data-i18n="popular_questions">ğŸ”¥ Popular Questions</h3>
                    <div id="popularQuestions"></div>
                    <hr class="rp-hr">
                    <h3 class="rp-title" data-i18n="recent_history">ğŸ• Recent History</h3>
                    <div id="historyList">
                        <p class="rp-empty">No queries yet</p>
                    </div>
                </aside>
            </section>

            <!-- PAGE: Weather -->
            <section id="page-weather" class="page">
                <div class="page-pad">
                    <h2 class="page-title" data-i18n="weather_title">ğŸŒ¤ï¸ Weather Forecast</h2>
                    <p class="page-sub" data-i18n="weather_sub">Real-time weather data for your region</p>
                    <div class="weather-location">\r\n <span>ğŸ“ Location:</span>\r\n <select id="weatherCity"
                            onchange="selectLocationFromDropdown(this)">
                            <option value="20.9320,77.7523">Amravati</option>
                            <option value="28.6139,77.2090">Delhi</option>
                            <option value="19.0760,72.8777">Mumbai</option>
                            <option value="21.1458,79.0882">Nagpur</option>
                            <option value="26.9124,75.7873">Jaipur</option>
                            <option value="25.3176,82.9739">Varanasi</option>
                            <option value="30.7333,76.7794">Chandigarh</option>
                            <option value="26.8467,80.9462">Lucknow</option>
                            <option value="23.2599,77.4126">Bhopal</option>
                            <option value="12.9716,77.5946">Bangalore</option>
                            <option value="13.0827,80.2707">Chennai</option>
                        </select>
                    </div>
                    <div class="weather-current" id="weatherCurrent">
                        <div class="skeleton" style="height:180px;border-radius:20px"></div>
                    </div>
                    <h3 class="section-title" data-i18n="seven_day_forecast">ğŸ“… 7-Day Forecast</h3>
                    <div class="forecast-grid" id="forecastGrid">
                        <div class="skeleton" style="height:120px;border-radius:16px"></div>
                        <div class="skeleton" style="height:120px;border-radius:16px"></div>
                        <div class="skeleton" style="height:120px;border-radius:16px"></div>
                    </div>
                </div>
            </section>

            <!-- PAGE: Market -->
            <section id="page-market" class="page">
                <div class="page-pad">
                    <h2 class="page-title" data-i18n="market_title">ğŸ’° Market Prices</h2>
                    <p class="page-sub" data-i18n="market_sub">Live mandi rates from across India</p>
                    <div class="market-grid" id="marketGrid">
                        <div class="skeleton" style="height:100px;border-radius:16px"></div>
                        <div class="skeleton" style="height:100px;border-radius:16px"></div>
                        <div class="skeleton" style="height:100px;border-radius:16px"></div>
                    </div>
                </div>
            </section>

            <!-- PAGE: Crops -->
            <section id="page-crops" class="page">
                <div class="page-pad">
                    <h2 class="page-title" data-i18n="crop_title">ğŸŒ± Crop Guide</h2>
                    <p class="page-sub" data-i18n="crop_sub">Complete growing guide for major Indian crops</p>
                    <div class="crops-grid" id="cropsGrid">
                        <div class="skeleton" style="height:200px;border-radius:16px"></div>
                        <div class="skeleton" style="height:200px;border-radius:16px"></div>
                    </div>
                </div>
            </section>

            <!-- PAGE: Pests -->
            <section id="page-pests" class="page">
                <div class="page-pad">
                    <h2 class="page-title" data-i18n="pest_title">ğŸ› Pest Solutions</h2>
                    <p class="page-sub" data-i18n="pest_sub">Identify and treat common crop pests and diseases</p>
                    <div class="pests-grid" id="pestsGrid">
                        <div class="skeleton" style="height:200px;border-radius:16px"></div>
                        <div class="skeleton" style="height:200px;border-radius:16px"></div>
                    </div>
                </div>
            </section>

            <!-- PAGE: Price Prediction -->
            <section id="page-prediction" class="page">
                <div class="page-pad">
                    <div class="pred-header">
                        <div>
                            <h2 class="page-title">ğŸ“ˆ Crop Price Prediction</h2>
                            <p class="page-sub">AI-powered price forecast and farmer advisory <span id="predSourceBadge"
                                    class="pred-source-badge"></span> <span id="predLastUpdated"
                                    style="font-size:0.75rem;opacity:0.6;margin-left:8px"></span></p>
                        </div>
                        <div class="pred-group-controls" style="display:flex;gap:12px;align-items:flex-end">
                            <div class="pred-control-item">
                                <label for="predStateSelect"
                                    style="display:block;font-size:0.75rem;margin-bottom:4px;opacity:0.8">State:</label>
                                <select id="predStateSelect"
                                    onchange="loadPricePrediction(document.getElementById('predCropSelect').value)">
                                    <option value="">National Average</option>
                                    <option value="Maharashtra">Maharashtra</option>
                                    <option value="Uttar Pradesh">Uttar Pradesh</option>
                                    <option value="Punjab">Punjab</option>
                                    <option value="Rajasthan">Rajasthan</option>
                                    <option value="Madhya Pradesh">Madhya Pradesh</option>
                                    <option value="Gujarat">Gujarat</option>
                                    <option value="Haryana">Haryana</option>
                                    <option value="Karnataka">Karnataka</option>
                                    <option value="West Bengal">West Bengal</option>
                                    <option value="Andhra Pradesh">Andhra Pradesh</option>
                                </select>
                            </div>
                            <div class="pred-control-item">
                                <label for="predCropSelect"
                                    style="display:block;font-size:0.75rem;margin-bottom:4px;opacity:0.8">Crop:</label>
                                <select id="predCropSelect" onchange="loadPricePrediction(this.value)">
                                    <option value="Wheat">ğŸŒ¾ Wheat</option>
                                    <option value="Rice">ğŸš Rice</option>
                                    <option value="Mustard">ğŸŒ» Mustard</option>
                                    <option value="Cotton">ğŸµï¸ Cotton</option>
                                    <option value="Soyabean">ğŸ«˜ Soyabean</option>
                                    <option value="Maize">ğŸŒ½ Maize</option>
                                    <option value="Gram">ğŸ«˜ Gram</option>
                                    <option value="Onion">ğŸ§… Onion</option>
                                    <option value="Tomato">ğŸ… Tomato</option>
                                    <option value="Potato">ğŸ¥” Potato</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Metrics Row -->
                    <div class="pred-metrics" id="predMetrics">
                        <div class="pred-metric-card">
                            <span class="pred-metric-label">Current Price</span>
                            <span class="pred-metric-val" id="predCurrentPrice">--</span>
                            <span class="pred-metric-unit">per quintal</span>
                        </div>
                        <div class="pred-metric-card">
                            <span class="pred-metric-label">MSP (Govt.)</span>
                            <span class="pred-metric-val" id="predMSP">--</span>
                            <span class="pred-metric-unit">guaranteed</span>
                        </div>
                        <div class="pred-metric-card">
                            <span class="pred-metric-label">30-Day Forecast</span>
                            <span class="pred-metric-val" id="predForecast">--</span>
                            <span class="pred-metric-unit" id="predForecastChange">--</span>
                        </div>
                        <div class="pred-metric-card">
                            <span class="pred-metric-label">Trend</span>
                            <span class="pred-metric-val" id="predTrend">--</span>
                            <span class="pred-metric-unit" id="predConfidence">--</span>
                            <div id="predSourceMetric" style="font-size: 0.65rem; margin-top: 0.4rem; opacity: 0.7;">
                            </div>
                        </div>
                    </div>

                    <!-- Prediction Chart -->
                    <div class="pred-chart-wrap">
                        <h3 class="section-title">Price History and Forecast</h3>
                        <div class="pred-chart-container">
                            <canvas id="predictionChart"></canvas>
                        </div>
                        <div class="pred-chart-legend">
                            <span class="legend-item"><span class="legend-dot" style="background:#3b82f6"></span>
                                Historical Price</span>
                            <span class="legend-item"><span class="legend-dot"
                                    style="background:#22c55e;border:2px dashed #22c55e;background:transparent"></span>
                                Predicted Price</span>
                            <span class="legend-item"><span class="legend-dot" style="background:#ef4444"></span> MSP
                                Reference</span>
                            <span class="legend-item"><span class="legend-dot"
                                    style="background:rgba(34,197,94,0.15);border:1px solid #22c55e"></span> Confidence
                                Band</span>
                        </div>
                    </div>

                    <!-- How It Works / Methodology Panel -->
                    <div class="pred-methodology" id="predMethodology">
                        <h3 class="section-title">ğŸ§  How Prediction Works</h3>
                        <div class="pred-method-grid">
                            <div class="pred-method-card">
                                <div class="pred-method-icon">ğŸ“Š</div>
                                <div class="pred-method-title">Data Source</div>
                                <div class="pred-method-desc" id="methodDataSource">Loading...</div>
                            </div>
                            <div class="pred-method-card">
                                <div class="pred-method-icon">ğŸ¤–</div>
                                <div class="pred-method-title">AI Model</div>
                                <div class="pred-method-desc" id="methodModel">Weighted Moving Avg + Linear Regression
                                </div>
                            </div>
                            <div class="pred-method-card">
                                <div class="pred-method-icon">ğŸ¯</div>
                                <div class="pred-method-title">Accuracy Range</div>
                                <div class="pred-method-desc" id="methodAccuracy">Best for 7-14 day forecasts</div>
                            </div>
                            <div class="pred-method-card">
                                <div class="pred-method-icon">ğŸ”„</div>
                                <div class="pred-method-title">Data Points</div>
                                <div class="pred-method-desc" id="methodDataPoints">--</div>
                            </div>
                        </div>

                        <!-- Feature Tags -->
                        <div class="pred-features-row" id="predFeaturesRow">
                            <span class="pred-feature-tag">WMA-30</span>
                            <span class="pred-feature-tag">Trend Slope</span>
                            <span class="pred-feature-tag">Seasonal Pattern</span>
                            <span class="pred-feature-tag">MSP Reference</span>
                            <span class="pred-feature-tag">Confidence Band</span>
                            <span class="pred-feature-tag">Interpolation</span>
                        </div>

                        <!-- Accuracy Note -->
                        <div class="pred-accuracy-note" id="predAccuracyNote">
                            <strong>ğŸ“ Note:</strong> Predictions are based on real mandi data from data.gov.in.
                            Predictions use trend extrapolation â€” most reliable for 7-14 days, less accurate beyond 30
                            days.
                            Agriculture prices depend on rainfall, policy changes, and local supply â€” no model can claim
                            high certainty.
                            Always combine with local market knowledge and consult your Agriculture Officer.
                        </div>
                    </div>

                    <!-- Tabbed Insights Section -->
                    <div class="pred-tabs-section">
                        <div class="pred-tabs-nav">
                            <button class="pred-tab active" data-tab="advisory"
                                onclick="switchPredTab('advisory', this)">
                                ğŸ“‹ Advisory</button>
                            <button class="pred-tab" data-tab="sell-timing"
                                onclick="switchPredTab('sell-timing', this)">
                                ğŸ• Sell Timing</button>
                            <button class="pred-tab" data-tab="crop-tips" onclick="switchPredTab('crop-tips', this)">
                                ğŸŒ¾ Crop Tips</button>
                            <button class="pred-tab" data-tab="market-compare"
                                onclick="switchPredTab('market-compare', this)">
                                ğŸ“ Market Info</button>
                        </div>

                        <!-- TAB: Advisory -->
                        <div class="pred-tab-content active" id="tab-advisory">
                            <h3 class="section-title">Farmer Advisory â€” All Crops <span id="advisoryLocationBadge"
                                    style="font-size:0.75rem;font-weight:400;opacity:0.6;margin-left:8px"></span></h3>
                            <p class="page-sub" style="margin-bottom:1rem">Buy/sell/hold guidance based on Agmarknet
                                mandi
                                data and MSP 2025-26 (CCEA, Govt. of India)</p>
                            <div class="pred-advisory-grid" id="advisoryGrid">
                                <div class="skeleton" style="height:140px;border-radius:16px"></div>
                                <div class="skeleton" style="height:140px;border-radius:16px"></div>
                                <div class="skeleton" style="height:140px;border-radius:16px"></div>
                            </div>
                            <p class="pred-disclaimer">MSP values are CCEA-approved 2025-26 figures (pib.gov.in). Price
                                forecasts are model estimates â€” not published by any government authority. Consult your
                                nearest APMC or Agriculture Officer before selling.</p>
                        </div>

                        <!-- TAB: Sell Timing -->
                        <div class="pred-tab-content" id="tab-sell-timing">
                            <h3 class="section-title">ğŸ• Optimal Sell Timing <span id="sellTimingCrop"
                                    style="font-size:0.75rem;font-weight:400;opacity:0.6;margin-left:8px"></span></h3>
                            <p class="page-sub" style="margin-bottom:1rem">AI analysis of when to sell for maximum
                                profit based on 30-day forecast</p>
                            <div id="sellTimingContent">
                                <div class="skeleton" style="height:200px;border-radius:16px"></div>
                            </div>
                        </div>

                        <!-- TAB: Crop Tips -->
                        <div class="pred-tab-content" id="tab-crop-tips">
                            <h3 class="section-title">ğŸŒ¾ Alternative Crop Recommendations <span id="cropTipsCrop"
                                    style="font-size:0.75rem;font-weight:400;opacity:0.6;margin-left:8px"></span></h3>
                            <p class="page-sub" style="margin-bottom:1rem">If current crop prices are unfavorable, here
                                are better alternatives ranked by forecast</p>
                            <div id="cropTipsContent">
                                <div class="skeleton" style="height:200px;border-radius:16px"></div>
                            </div>
                        </div>

                        <!-- TAB: Market Compare -->
                        <div class="pred-tab-content" id="tab-market-compare">
                            <h3 class="section-title">ğŸ“ Inter-State Price Comparison <span id="marketCompareCrop"
                                    style="font-size:0.75rem;font-weight:400;opacity:0.6;margin-left:8px"></span></h3>
                            <p class="page-sub" style="margin-bottom:1rem">Compare mandi prices across states â€” sell
                                where you get the best rate</p>
                            <div id="marketCompareContent">
                                <div class="skeleton" style="height:200px;border-radius:16px"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- LOCATION PICKER MODAL -->
    <div id="locationModal" class="loc-modal-overlay">
        <div class="loc-modal">
            <h3 class="loc-modal-title" data-i18n="loc_title">ğŸ“ Select Your Location</h3>
            <p class="loc-modal-sub" data-i18n="loc_sub">Choose your nearest city for accurate weather, market prices,
                and AI advice</p>
            <input type="text" id="locSearch" class="loc-search" placeholder="ğŸ” Search city..."
                oninput="filterLocations(this.value)">
            <div class="loc-grid" id="locGrid">
                <!-- Maharashtra -->
                <div class="loc-region">Maharashtra</div>
                <button class="loc-btn" onclick="selectLocation('Amravati','20.9320','77.7523')">Amravati</button>
                <button class="loc-btn" onclick="selectLocation('Nagpur','21.1458','79.0882')">Nagpur</button>
                <button class="loc-btn" onclick="selectLocation('Mumbai','19.0760','72.8777')">Mumbai</button>
                <button class="loc-btn" onclick="selectLocation('Pune','18.5204','73.8567')">Pune</button>
                <button class="loc-btn" onclick="selectLocation('Nashik','19.9975','73.7898')">Nashik</button>
                <button class="loc-btn" onclick="selectLocation('Aurangabad','19.8762','75.3433')">Aurangabad</button>
                <button class="loc-btn" onclick="selectLocation('Kolhapur','16.7050','74.2433')">Kolhapur</button>
                <button class="loc-btn" onclick="selectLocation('Solapur','17.6599','75.9064')">Solapur</button>
                <!-- North India -->
                <div class="loc-region">North India</div>
                <button class="loc-btn" onclick="selectLocation('Delhi','28.6139','77.2090')">Delhi</button>
                <button class="loc-btn" onclick="selectLocation('Lucknow','26.8467','80.9462')">Lucknow</button>
                <button class="loc-btn" onclick="selectLocation('Jaipur','26.9124','75.7873')">Jaipur</button>
                <button class="loc-btn" onclick="selectLocation('Chandigarh','30.7333','76.7794')">Chandigarh</button>
                <button class="loc-btn" onclick="selectLocation('Varanasi','25.3176','82.9739')">Varanasi</button>
                <button class="loc-btn" onclick="selectLocation('Bhopal','23.2599','77.4126')">Bhopal</button>
                <button class="loc-btn" onclick="selectLocation('Indore','22.7196','75.8577')">Indore</button>
                <button class="loc-btn" onclick="selectLocation('Agra','27.1767','78.0081')">Agra</button>
                <!-- South India -->
                <div class="loc-region">South India</div>
                <button class="loc-btn" onclick="selectLocation('Bangalore','12.9716','77.5946')">Bangalore</button>
                <button class="loc-btn" onclick="selectLocation('Chennai','13.0827','80.2707')">Chennai</button>
                <button class="loc-btn" onclick="selectLocation('Hyderabad','17.3850','78.4867')">Hyderabad</button>
                <button class="loc-btn" onclick="selectLocation('Kochi','9.9312','76.2673')">Kochi</button>
                <!-- Andhra Pradesh -->
                <div class="loc-region">Andhra Pradesh</div>
                <button class="loc-btn" onclick="selectLocation('Vijayawada','16.5062','80.6480')">Vijayawada</button>
                <button class="loc-btn"
                    onclick="selectLocation('Visakhapatnam','17.6868','83.2185')">Visakhapatnam</button>
                <button class="loc-btn" onclick="selectLocation('Guntur','16.3067','80.4365')">Guntur</button>
                <button class="loc-btn" onclick="selectLocation('Nellore','14.4426','79.9865')">Nellore</button>
                <!-- East India -->
                <div class="loc-region">East India</div>
                <button class="loc-btn" onclick="selectLocation('Kolkata','22.5726','88.3639')">Kolkata</button>
                <button class="loc-btn" onclick="selectLocation('Patna','25.6093','85.1376')">Patna</button>
                <button class="loc-btn" onclick="selectLocation('Ranchi','23.3441','85.3096')">Ranchi</button>
                <!-- West India -->
                <div class="loc-region">West & Central</div>
                <button class="loc-btn" onclick="selectLocation('Ahmedabad','23.0225','72.5714')">Ahmedabad</button>
                <button class="loc-btn" onclick="selectLocation('Rajkot','22.3039','70.8022')">Rajkot</button>
                <button class="loc-btn" onclick="selectLocation('Raipur','21.2514','81.6296')">Raipur</button>
                <!-- Punjab & Haryana -->
                <div class="loc-region">Punjab & Haryana</div>
                <button class="loc-btn" onclick="selectLocation('Ludhiana','30.9010','75.8573')">Ludhiana</button>
                <button class="loc-btn" onclick="selectLocation('Karnal','29.6857','76.9905')">Karnal</button>
                <button class="loc-btn" onclick="selectLocation('Amritsar','31.6340','74.8723')">Amritsar</button>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <script src="/dashboard/app.js"></script>
</body>

</html>