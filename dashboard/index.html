<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KrishiMind AI â€” Smart Agriculture Assistant</title>
    <meta name="description" content="AI-powered agricultural advisor for Indian farmers">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="/dashboard/styles.css">
</head>

<body>
    <!-- SIDEBAR -->
    <aside id="sidebar" class="sidebar">
        <div class="sidebar-logo">
            <div class="logo-icon">ğŸŒ¾</div>
            <div>
                <h1 class="logo-text">KrishiMind AI</h1>
                <p class="logo-sub">Powered by watsonx</p>
            </div>
        </div>
        <nav class="nav">
            <a href="#" class="nav-item active" data-page="dashboard" onclick="navigate('dashboard',this)">
                <span>ğŸ“Š</span> <span data-i18n="nav_dashboard">Dashboard</span></a>
            <a href="#" class="nav-item" data-page="chat" onclick="navigate('chat',this)">
                <span>ğŸ¤–</span> <span data-i18n="nav_ask_ai">Ask AI</span>
                <span class="nav-badge"><span class="pulse-dot"></span> <span
                        data-i18n="nav_online">Online</span></span></a>
            <a href="#" class="nav-item" data-page="weather" onclick="navigate('weather',this)">
                <span>ğŸŒ¤ï¸</span> <span data-i18n="nav_weather">Weather</span></a>
            <a href="#" class="nav-item" data-page="market" onclick="navigate('market',this)">
                <span>ğŸ’°</span> <span data-i18n="nav_market">Market Prices</span></a>
            <a href="#" class="nav-item" data-page="crops" onclick="navigate('crops',this)">
                <span>ğŸŒ±</span> <span data-i18n="nav_crops">Crop Guide</span></a>
            <a href="#" class="nav-item" data-page="pests" onclick="navigate('pests',this)">
                <span>ğŸ›</span> <span data-i18n="nav_pests">Pest Solutions</span></a>
        </nav>
        <div class="sidebar-bottom">
            <div class="lang-select">
                <span>ğŸŒ</span>
                <select id="langSelect">
                    <option value="en">English</option>
                    <option value="hi">à¤¹à¤¿à¤¨à¥à¤¦à¥€</option>
                    <option value="mr">à¤®à¤°à¤¾à¤ à¥€</option>
                    <option value="te">à°¤à±†à°²à±à°—à±</option>
                    <option value="ta">à®¤à®®à®¿à®´à¯</option>
                </select>
            </div>
            <div class="user-info">
                <div class="user-avatar">ğŸ‘¤</div>
                <div style="flex:1">
                    <p class="user-name">User</p>
                    <p class="user-role" style="font-size:0.7rem;color:#059669">â— Online</p>
                </div>
                <button onclick="logout()"
                    style="background:none;border:none;cursor:pointer;font-size:1.2rem;opacity:0.7"
                    title="Logout">ğŸšª</button>
            </div>
        </div>
    </aside>

    <!-- MAIN -->
    <main class="main">
        <!-- Header -->
        <header class="header">
            <button class="menu-btn" onclick="toggleSidebar()">â˜°</button>
            <div class="search-wrap">
                <span class="search-icon">ğŸ”</span>
                <input id="globalSearch" type="text" data-i18n-ph="search_placeholder"
                    placeholder="Ask anything about farming..."
                    onkeydown="if(event.key==='Enter'){navigate('chat');askFromGlobal(this.value);this.value=''}">
            </div>
            <button onclick="showLocationPicker()" id="locationBadge" class="location-badge" title="Change location">
                ğŸ“ <span id="locationBadgeText" data-i18n="select_location">Select Location</span>
            </button>
            <button onclick="askFromGlobal(document.getElementById('globalSearch').value)" class="ask-btn">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" />
                </svg> <span data-i18n="btn_ask">Ask</span>
            </button>
            <button onclick="toggleOnline()" id="modeBtn" class="mode-btn online">
                <span id="modeDot" class="mode-dot"></span>
                <span id="modeText">Online</span>
            </button>
        </header>

        <!-- Pages Container -->
        <div class="pages">
            <!-- PAGE: Dashboard (Bento Grid) -->
            <section id="page-dashboard" class="page active">
                <div class="page-pad">
                    <!-- ROW 1: Hero Banner -->
                    <div class="hero-banner" id="heroBanner">
                        <div class="hero-content">
                            <p class="hero-greeting" id="heroGreeting" data-i18n="hero_greeting">Good Evening</p>
                            <h2 class="hero-title" data-i18n="hero_welcome">Welcome back, Farmer! ğŸ‘‹</h2>
                            <p class="hero-sub" id="heroSub" data-i18n="hero_sub">Loading farm overview...</p>
                        </div>
                        <div class="hero-right">
                            <div class="hero-date" id="heroDate"></div>
                            <div class="hero-weather-mini" id="heroWeatherMini">
                                <span class="hero-temp" id="heroTemp">--Â°</span>
                                <span class="hero-wicon" id="heroWicon">ğŸŒ¤ï¸</span>
                            </div>
                        </div>
                        <div class="hero-pattern"></div>
                    </div>

                    <!-- ROW 2: Bento Grid -->
                    <div class="bento-grid">
                        <!-- Wheat Price (with sparkline) -->
                        <div class="bento-card bento-wheat" onclick="navigate('market')" style="--delay:0">
                            <div class="stat-top"><span class="stat-label" data-i18n="wheat_price">Wheat
                                    Price</span><span class="stat-icon bg-amber">ğŸŒ¾</span></div>
                            <p class="stat-val" id="dashWheatPrice">â‚¹2,450<span class="stat-unit">/qt</span></p>
                            <p class="stat-delta up" id="dashWheatDelta">â†‘ 3.2%</p>
                            <canvas id="wheatSparkline" class="sparkline-canvas" width="160" height="36"></canvas>
                        </div>

                        <!-- Weather (with mini forecast) -->
                        <div class="bento-card bento-weather" onclick="navigate('weather')" style="--delay:1">
                            <div class="stat-top"><span class="stat-label" data-i18n="weather">Weather</span><span
                                    class="stat-icon bg-blue">ğŸŒ¤ï¸</span></div>
                            <p class="stat-val" id="dashTemp">--Â°C</p>
                            <p class="stat-delta" id="dashWeatherDesc">Loading...</p>
                            <div class="mini-forecast" id="miniForecast"></div>
                        </div>

                        <!-- Soil Health (merged gauge) -->
                        <div class="bento-card bento-soil" style="--delay:2">
                            <div class="stat-top"><span class="stat-label" data-i18n="soil_health">Soil
                                    Health</span><span class="stat-icon bg-green">ğŸ§ª</span></div>
                            <div class="gauge-wrap">
                                <svg class="gauge-ring" viewBox="0 0 80 80">
                                    <circle cx="40" cy="40" r="34" fill="none" stroke="#e5e7eb" stroke-width="6" />
                                    <circle id="soilGaugeCircle" cx="40" cy="40" r="34" fill="none" stroke="#22c55e"
                                        stroke-width="6" stroke-linecap="round" stroke-dasharray="213.6"
                                        stroke-dashoffset="213.6" transform="rotate(-90 40 40)"
                                        style="transition:stroke-dashoffset 1.5s ease" />
                                </svg>
                                <div class="gauge-center">
                                    <span class="gauge-val" id="dashSoilVal">--</span>
                                    <span class="gauge-label" data-i18n="moisture">Moisture</span>
                                </div>
                            </div>
                            <p class="stat-delta" id="dashSoilStatus">Loading...</p>
                        </div>

                        <!-- AI Daily Tip (tall anchor card) -->
                        <div class="bento-card bento-aitip" style="--delay:3" id="aiTipCard">
                            <div class="aitip-glow"></div>
                            <div class="aitip-header">
                                <span class="aitip-icon">ğŸ¤–</span>
                                <div>
                                    <p class="aitip-title" data-i18n="ai_daily_tip">AI Daily Tip</p>
                                    <p class="aitip-sub" data-i18n="powered_by">Powered by KrishiMind AI</p>
                                </div>
                            </div>
                            <div class="aitip-body" id="aiTipBody">
                                <div class="skeleton" style="height:14px;width:90%;border-radius:6px;margin-bottom:8px">
                                </div>
                                <div class="skeleton" style="height:14px;width:75%;border-radius:6px;margin-bottom:8px">
                                </div>
                                <div class="skeleton" style="height:14px;width:60%;border-radius:6px"></div>
                            </div>
                            <button class="aitip-ask"
                                onclick="navigate('chat');setTimeout(()=>askQuestion('Give me a farming tip for today based on current weather and season'),300)">
                                <span data-i18n="ask_more">Ask more â†’</span>
                            </button>
                        </div>

                        <!-- 7-Day Temperature Chart -->
                        <div class="bento-card bento-chart" style="--delay:4">
                            <div class="stat-top"><span class="stat-label" data-i18n="seven_day_temp">ğŸ“ˆ 7-Day
                                    Temperature</span></div>
                            <canvas id="tempChart" class="temp-chart-canvas"></canvas>
                        </div>

                        <!-- Market Ticker -->
                        <div class="bento-card bento-ticker" style="--delay:5">
                            <div class="stat-top"><span class="stat-label" data-i18n="market_prices_top">ğŸ’° Market
                                    Prices â€” Top Crops</span>
                                <a href="#" onclick="event.preventDefault();navigate('market')" class="ticker-link"
                                    data-i18n="view_all">View
                                    all â†’</a>
                            </div>
                            <div class="ticker-scroll" id="tickerScroll">
                                <div class="skeleton" style="height:56px;width:140px;border-radius:12px;flex-shrink:0">
                                </div>
                                <div class="skeleton" style="height:56px;width:140px;border-radius:12px;flex-shrink:0">
                                </div>
                                <div class="skeleton" style="height:56px;width:140px;border-radius:12px;flex-shrink:0">
                                </div>
                            </div>
                        </div>

                        <!-- Quick Actions -->
                        <div class="bento-card bento-actions" style="--delay:6">
                            <p class="bento-section-head" data-i18n="quick_actions">âš¡ Quick Actions</p>
                            <div class="quick-grid">
                                <button class="quick-card"
                                    onclick="navigate('chat');setTimeout(()=>askQuestion('What crops should I plant this season?'),300)">
                                    <span class="quick-icon">ğŸŒ±</span>
                                    <div><strong data-i18n="qa_crop">Crop Advice</strong><small
                                            data-i18n="qa_crop_sub">AI recommendation</small></div>
                                </button>
                                <button class="quick-card"
                                    onclick="navigate('chat');setTimeout(()=>askQuestion('How to control pests in my farm?'),300)">
                                    <span class="quick-icon">ğŸ›</span>
                                    <div><strong data-i18n="qa_pest">Pest Check</strong><small
                                            data-i18n="qa_pest_sub">Identify & treat</small></div>
                                </button>
                                <button class="quick-card" onclick="navigate('weather')">
                                    <span class="quick-icon">ğŸŒ§ï¸</span>
                                    <div><strong data-i18n="qa_weather">Weather</strong><small
                                            data-i18n="qa_weather_sub">7-day forecast</small></div>
                                </button>
                                <button class="quick-card" onclick="navigate('market')">
                                    <span class="quick-icon">ğŸ“ˆ</span>
                                    <div><strong data-i18n="qa_market">Market</strong><small
                                            data-i18n="qa_market_sub">Live mandi rates</small></div>
                                </button>
                            </div>
                        </div>

                        <!-- Crop Calendar -->
                        <div class="bento-card bento-calendar" style="--delay:7">
                            <p class="bento-section-head">ğŸ—“ï¸ Crop Calendar â€” <span id="calSeasonName">Rabi
                                    Season</span></p>
                            <div class="calendar-timeline" id="cropCalendar"></div>
                        </div>

                        <!-- Popular Questions -->
                        <div class="bento-card bento-popular" style="--delay:8">
                            <p class="bento-section-head" data-i18n="popular_questions">ğŸ”¥ Popular Questions</p>
                            <div id="dashPopular" class="popular-grid"></div>
                        </div>

                        <!-- Activity Feed -->
                        <div class="bento-card bento-feed" style="--delay:9">
                            <p class="bento-section-head" data-i18n="activity_feed">ğŸ“ Activity Feed</p>
                            <div id="activityFeed" class="activity-feed">
                                <div class="feed-item feed-system"><span class="feed-dot dot-green"></span>
                                    <div>
                                        <p>System online â€” FAISS index loaded</p><small>Just now</small>
                                    </div>
                                </div>
                                <div class="feed-item feed-system"><span class="feed-dot dot-blue"></span>
                                    <div>
                                        <p>AI service connected (Gemini)</p><small>Just now</small>
                                    </div>
                                </div>
                                <div class="feed-item feed-system"><span class="feed-dot dot-amber"></span>
                                    <div>
                                        <p>Weather data synced</p><small>Just now</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- PAGE: Chat -->
            <section id="page-chat" class="page">
                <div class="chat-container">
                    <div id="chatArea" class="chat-area">
                        <div class="chat-welcome">
                            <div class="cw-icon">ğŸŒ¾</div>
                            <h2 data-i18n="chat_welcome">Welcome to KrishiMind AI</h2>
                            <p data-i18n="chat_welcome_sub">Ask any farming question â€” crop advice, pest control,
                                weather, market prices</p>
                        </div>
                    </div>
                    <div class="chat-input-bar">
                        <input id="chatInput" type="text" data-i18n-ph="chat_placeholder"
                            placeholder="Type your farming question..." onkeydown="if(event.key==='Enter')sendChat()">
                        <button onclick="sendChat()" class="chat-send">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" />
                            </svg>
                        </button>
                    </div>
                </div>
                <!-- Right Panel -->
                <aside class="right-panel">
                    <h3 class="rp-title" data-i18n="popular_questions">ğŸ”¥ Popular Questions</h3>
                    <div id="popularQuestions"></div>
                    <hr class="rp-hr">
                    <h3 class="rp-title" data-i18n="recent_history">ğŸ• Recent History</h3>
                    <div id="historyList">
                        <p class="rp-empty">No queries yet</p>
                    </div>
                </aside>
            </section>

            <!-- PAGE: Weather -->
            <section id="page-weather" class="page">
                <div class="page-pad">
                    <h2 class="page-title" data-i18n="weather_title">ğŸŒ¤ï¸ Weather Forecast</h2>
                    <p class="page-sub" data-i18n="weather_sub">Real-time weather data for your region</p>
                    <div class="weather-location">\r\n <span>ğŸ“ Location:</span>\r\n <select id="weatherCity"
                            onchange="selectLocationFromDropdown(this)">
                            <option value="20.9320,77.7523">Amravati</option>
                            <option value="28.6139,77.2090">Delhi</option>
                            <option value="19.0760,72.8777">Mumbai</option>
                            <option value="21.1458,79.0882">Nagpur</option>
                            <option value="26.9124,75.7873">Jaipur</option>
                            <option value="25.3176,82.9739">Varanasi</option>
                            <option value="30.7333,76.7794">Chandigarh</option>
                            <option value="26.8467,80.9462">Lucknow</option>
                            <option value="23.2599,77.4126">Bhopal</option>
                            <option value="12.9716,77.5946">Bangalore</option>
                            <option value="13.0827,80.2707">Chennai</option>
                        </select>
                    </div>
                    <div class="weather-current" id="weatherCurrent">
                        <div class="skeleton" style="height:180px;border-radius:20px"></div>
                    </div>
                    <h3 class="section-title" data-i18n="seven_day_forecast">ğŸ“… 7-Day Forecast</h3>
                    <div class="forecast-grid" id="forecastGrid">
                        <div class="skeleton" style="height:120px;border-radius:16px"></div>
                        <div class="skeleton" style="height:120px;border-radius:16px"></div>
                        <div class="skeleton" style="height:120px;border-radius:16px"></div>
                    </div>
                </div>
            </section>

            <!-- PAGE: Market -->
            <section id="page-market" class="page">
                <div class="page-pad">
                    <h2 class="page-title" data-i18n="market_title">ğŸ’° Market Prices</h2>
                    <p class="page-sub" data-i18n="market_sub">Live mandi rates from across India</p>
                    <div class="market-grid" id="marketGrid">
                        <div class="skeleton" style="height:100px;border-radius:16px"></div>
                        <div class="skeleton" style="height:100px;border-radius:16px"></div>
                        <div class="skeleton" style="height:100px;border-radius:16px"></div>
                    </div>
                </div>
            </section>

            <!-- PAGE: Crops -->
            <section id="page-crops" class="page">
                <div class="page-pad">
                    <h2 class="page-title" data-i18n="crop_title">ğŸŒ± Crop Guide</h2>
                    <p class="page-sub" data-i18n="crop_sub">Complete growing guide for major Indian crops</p>
                    <div class="crops-grid" id="cropsGrid">
                        <div class="skeleton" style="height:200px;border-radius:16px"></div>
                        <div class="skeleton" style="height:200px;border-radius:16px"></div>
                    </div>
                </div>
            </section>

            <!-- PAGE: Pests -->
            <section id="page-pests" class="page">
                <div class="page-pad">
                    <h2 class="page-title" data-i18n="pest_title">ğŸ› Pest Solutions</h2>
                    <p class="page-sub" data-i18n="pest_sub">Identify and treat common crop pests and diseases</p>
                    <div class="pests-grid" id="pestsGrid">
                        <div class="skeleton" style="height:200px;border-radius:16px"></div>
                        <div class="skeleton" style="height:200px;border-radius:16px"></div>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- LOCATION PICKER MODAL -->
    <div id="locationModal" class="loc-modal-overlay">
        <div class="loc-modal">
            <h3 class="loc-modal-title" data-i18n="loc_title">ğŸ“ Select Your Location</h3>
            <p class="loc-modal-sub" data-i18n="loc_sub">Choose your nearest city for accurate weather, market prices,
                and AI advice</p>
            <input type="text" id="locSearch" class="loc-search" placeholder="ğŸ” Search city..."
                oninput="filterLocations(this.value)">
            <div class="loc-grid" id="locGrid">
                <!-- Maharashtra -->
                <div class="loc-region">Maharashtra</div>
                <button class="loc-btn" onclick="selectLocation('Amravati','20.9320','77.7523')">Amravati</button>
                <button class="loc-btn" onclick="selectLocation('Nagpur','21.1458','79.0882')">Nagpur</button>
                <button class="loc-btn" onclick="selectLocation('Mumbai','19.0760','72.8777')">Mumbai</button>
                <button class="loc-btn" onclick="selectLocation('Pune','18.5204','73.8567')">Pune</button>
                <button class="loc-btn" onclick="selectLocation('Nashik','19.9975','73.7898')">Nashik</button>
                <button class="loc-btn" onclick="selectLocation('Aurangabad','19.8762','75.3433')">Aurangabad</button>
                <button class="loc-btn" onclick="selectLocation('Kolhapur','16.7050','74.2433')">Kolhapur</button>
                <button class="loc-btn" onclick="selectLocation('Solapur','17.6599','75.9064')">Solapur</button>
                <!-- North India -->
                <div class="loc-region">North India</div>
                <button class="loc-btn" onclick="selectLocation('Delhi','28.6139','77.2090')">Delhi</button>
                <button class="loc-btn" onclick="selectLocation('Lucknow','26.8467','80.9462')">Lucknow</button>
                <button class="loc-btn" onclick="selectLocation('Jaipur','26.9124','75.7873')">Jaipur</button>
                <button class="loc-btn" onclick="selectLocation('Chandigarh','30.7333','76.7794')">Chandigarh</button>
                <button class="loc-btn" onclick="selectLocation('Varanasi','25.3176','82.9739')">Varanasi</button>
                <button class="loc-btn" onclick="selectLocation('Bhopal','23.2599','77.4126')">Bhopal</button>
                <button class="loc-btn" onclick="selectLocation('Indore','22.7196','75.8577')">Indore</button>
                <button class="loc-btn" onclick="selectLocation('Agra','27.1767','78.0081')">Agra</button>
                <!-- South India -->
                <div class="loc-region">South India</div>
                <button class="loc-btn" onclick="selectLocation('Bangalore','12.9716','77.5946')">Bangalore</button>
                <button class="loc-btn" onclick="selectLocation('Chennai','13.0827','80.2707')">Chennai</button>
                <button class="loc-btn" onclick="selectLocation('Hyderabad','17.3850','78.4867')">Hyderabad</button>
                <button class="loc-btn" onclick="selectLocation('Kochi','9.9312','76.2673')">Kochi</button>
                <!-- East India -->
                <div class="loc-region">East India</div>
                <button class="loc-btn" onclick="selectLocation('Kolkata','22.5726','88.3639')">Kolkata</button>
                <button class="loc-btn" onclick="selectLocation('Patna','25.6093','85.1376')">Patna</button>
                <button class="loc-btn" onclick="selectLocation('Ranchi','23.3441','85.3096')">Ranchi</button>
                <!-- West India -->
                <div class="loc-region">West & Central</div>
                <button class="loc-btn" onclick="selectLocation('Ahmedabad','23.0225','72.5714')">Ahmedabad</button>
                <button class="loc-btn" onclick="selectLocation('Rajkot','22.3039','70.8022')">Rajkot</button>
                <button class="loc-btn" onclick="selectLocation('Raipur','21.2514','81.6296')">Raipur</button>
                <!-- Punjab & Haryana -->
                <div class="loc-region">Punjab & Haryana</div>
                <button class="loc-btn" onclick="selectLocation('Ludhiana','30.9010','75.8573')">Ludhiana</button>
                <button class="loc-btn" onclick="selectLocation('Karnal','29.6857','76.9905')">Karnal</button>
                <button class="loc-btn" onclick="selectLocation('Amritsar','31.6340','74.8723')">Amritsar</button>
            </div>
        </div>
    </div>

    <script src="/dashboard/app.js"></script>
</body>

</html>